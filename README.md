# ipro2excel
 Makes XLSX files for prices and remains from ETM API, using box/scout.

Импортирование информации по продукции из системы iPro ETM (API) и сохранение в Excel файлы. 
Описание ETM API - в каталоге docs.

В проекте используются внешние компоненты:
	1. Box/Spout - работа с Excel таблицами.

Порядок установки.

1. Загрузить архив на хостинг в public_html
2. Распаковать архив. Будет создана папка ipro2excel-main.
3. В папке находится файл config.ini. Он содержит настройки доступа к системам. Рекомендуется заменить пароли/логины после установки.
4. Нужно дать права www-пользователя и www-группы на папку tmp в каталоге etm2excel. Альтернатива: в config.ini указать уже имеющуюся доступную папку для временных файлов. Компонент box/scout использует tmp-папку для создания временных каталогов вида "xlsx[цифры]".

Порядок работы.

1. Получение файла с товарами (весо-габаритные характеристики).
- Выложить в папку ipro2excel файл с артикулами, назвать article.txt. Каждый артикул идет с новой строки. 
- Запустить http://вашсайт.ру/ipro2excel/getgoodsfile.php 
- Результат сохранится в виде файла exportgoods.xlsx (название меняется в config.ini, ключ xlsxgoodsfilename). 
- Скачать файл можно по url http://вашсайт.ру/ipro2excel/tmp/exportgoods.xlsx

2. Получение файла с ценами и остатками.
- Выложить в папку ipro2excel/tmp исходный файл с артикулами, имя файла указано в конфигурационном файле, ключ 
- Запустить http://вашсайт.ру/ipro2excel/getgoodsfile.php 
- Результат сохранится в виде файла exportprices.xlsx (название меняется в config.ini, ключ xlsxpricesfilename) на FTP-сервер, указанный в конфигурационном файле.
- Скачать файл можно по url http://вашсайт.ру/ipro2excel/tmp/exportprices.xlsx

Дополнительная информация по файлу с ценами.
1. При необходимости файл исходный Excel можно расширить дополнительными полями, описав поля в конфигурационном файле, секция PricesFileColumns
2. Характеристики продукта из первого уровня можно получить без программирования, описав их в секции GoodsFieldsMapping.

Конец документа.